<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Messaggi Personalizzati</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      min-height: 100vh;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 75%, #f5576c 100%);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    /* Container per le particelle */
    .particles-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }
    
    .particle {
      position: absolute;
      background-image: url('/static/sfondo.jpeg');
      background-size: cover;
      background-position: center;
      border-radius: 50%;
      opacity: 0.9;
      animation: float 15s infinite ease-in-out;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.6);
    }
    
    @keyframes float {
  0% {
    transform: translateY(0) translateX(0px) rotate(0deg);
    opacity: 0.8;
  }
  100% {
    transform: translateY(calc(-80vh - 100px)) translateX(calc(100px * var(--direction))) rotate(360deg);
    opacity: 0;
  }
}
    
    /* Header con spazio per le particelle */
    .header-space {
      height: 25vh;
      min-height: 150px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding: 20px;
      position: relative;
      z-index: 10;
    }
    
    .title {
      background: rgba(255, 255, 255, 0.95);
      padding: 15px 30px;
      border-radius: 25px;
      box-shadow: 0 8px 30px rgba(118, 75, 162, 0.3);
      backdrop-filter: blur(15px);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

        /* Logo */
/* Logo */
.logo-container {
  position: fixed; /* Cambiato da absolute a fixed */
  top: 15px; /* Posizionato in alto fisso */
  left: 50%;
  transform: translateX(-50%);
  z-index: 100; /* Aumentato z-index per stare sopra tutto */
  display: flex;
  justify-content: center;
  width: 100%;
  padding: 0 20px;
  pointer-events: none;
}

.logo {
  height: 180px; /* Aumentato da 140px a 180px */
  width: auto;
  max-width: 350px; /* Aumentato da 280px a 350px */
  box-shadow: none;
  border: none;
  background: transparent;
  border-radius: 0;
}
    
    .title h1 {
      background: linear-gradient(135deg, #667eea, #764ba2);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 24px;
      font-weight: 600;
      margin: 0;
    }
    
    /* Container centrale */
    .main-container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      position: relative;
      z-index: 10;
    }
    
    .form-container {
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 25px;
      box-shadow: 0 15px 40px rgba(118, 75, 162, 0.2);
      width: 100%;
      max-width: 380px;
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      position: relative;
      transition: all 0.3s ease;
    }
    
    .form-container.expanded {
      padding-bottom: 40px;
    }
    
    .form-container::before {
      content: '';
      position: absolute;
      top: -1px;
      left: -1px;
      right: -1px;
      bottom: -1px;
      background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
      border-radius: 25px;
      z-index: -1;
      opacity: 0.3;
    }
    
    input[type="text"] {
      width: 100%;
      padding: 15px 20px;
      font-size: 16px;
      border: 2px solid transparent;
      border-radius: 15px;
      margin-bottom: 20px;
      background: rgba(255, 255, 255, 0.9);
      transition: all 0.3s;
      outline: none;
    }
    
    input[type="text"]:focus {
      border-color: #764ba2;
      box-shadow: 0 0 20px rgba(118, 75, 162, 0.3);
      transform: translateY(-2px);
    }
    
    button {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      border: none;
      border-radius: 15px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
      margin-bottom: 15px;
      position: relative;
      overflow: hidden;
    }
    
    button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }
    
    button:hover::before {
      left: 100%;
    }
    
    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(118, 75, 162, 0.4);
    }
    
    button:active {
      transform: translateY(-1px);
    }
    
    #risultato {
      margin: 20px 0;
      padding: 15px;
      border-radius: 12px;
      min-height: 20px;
      background: rgba(102, 126, 234, 0.1);
      transition: all 0.3s ease;
      max-height: 0;
      opacity: 0;
      overflow: hidden;
    }
    
    #risultato.visible {
      opacity: 1;
      max-height: 200px;
    }
    
    #elencoNomi {
      opacity: 0;
      max-height: 0;
      overflow: hidden;
      transition: all 0.4s ease;
    }
    
    #elencoNomi.visible {
      opacity: 1;
      max-height: 300px;
    }
    
    #elencoNomi ul {
      background: rgba(102, 126, 234, 0.15);
      border-radius: 12px;
      padding: 15px;
      margin: 15px 0;
      list-style-position: inside;
    }
    
    #elencoNomi li {
      margin: 10px 0;
      padding: 8px 12px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      border-left: 3px solid #764ba2;
    }
    
    .loading {
      color: #764ba2;
      font-style: italic;
      text-align: center;
    }
    
    .error {
      color: #f5576c;
      font-weight: 600;
      text-align: center;
    }
    
    /* Footer */
    .footer-space {
      height: 20vh;
      min-height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
      z-index: 10;
    }
    
    .footer {
      background: rgba(255, 255, 255, 0.9);
      padding: 12px 25px;
      border-radius: 20px;
      font-size: 14px;
      color: #764ba2;
      backdrop-filter: blur(10px);
      box-shadow: 0 5px 20px rgba(118, 75, 162, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .header-space {
  height: 25vh; /* Ripristinato valore originale */
  min-height: 150px;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  padding: 20px;
  position: relative;
  z-index: 10;
  margin-top: 80px; /* Aggiunto margine superiore per fare spazio al logo */
}
      
      .footer-space {
        height: 15vh;
        min-height: 80px;
      }
      
      .title h1 {
        font-size: 20px;
      }
      
      .form-container {
        padding: 25px;
        margin: 0 10px;
      }
    }
    
    @media (max-width: 480px) {
      .header-space {
        height: 18vh;
        min-height: 100px;
      }
      
      .title {
        padding: 12px 20px;
        margin: 0 10px;
      }
      
      .title h1 {
        font-size: 18px;
      }
      
      .form-container {
        max-width: none;
        margin: 0 5px;
        padding: 20px;
      }
    }
@media (max-width: 768px) {
  .logo {
    height: 130px; /* Aumentato da 100px a 130px */
    max-width: 250px; /* Aumentato da 200px a 250px */
  }
}

@media (max-width: 480px) {
  .logo {
    height: 100px; /* Aumentato da 80px a 100px */
    max-width: 200px; /* Aumentato da 160px a 200px */
  }
}
  </style>
</head>
<body>
  <!-- Container delle particelle -->
  <div class="particles-container" id="particles"></div>

  <!-- Header -->
  <div class="header-space">
    <div class="title">
      <h1>‚ú® Ringraziamenti! ‚ú®</h1>
    </div>
  </div>
  <!-- Logo -->
<div class="logo-container">
  <img src="/static/logo.png" alt="Logo" class="logo">
</div>
  <!-- Container principale -->
  <div class="main-container">
    <div class="form-container" id="formContainer">
      <input type="text" id="nome" placeholder="Inserisci il tuo nome..." required>
      <button id="btnMessaggio">üîç Mostra il messaggio</button>
      
      <div id="risultato"></div>
      
      <button id="mostraElenco" type="button">üìã Elenco ringraziati</button>
      <div id="elencoNomi"></div>
    </div>
  </div>
  
  <!-- Footer -->
  <div class="footer-space">
    <!--<div class="footer">
      üíå Divertiti a scoprire il tuo messaggio personalizzato!
    </div>-->
  </div>

<script>
const input = document.getElementById("nome");
const btnMessaggio = document.getElementById("btnMessaggio");
const risultato = document.getElementById("risultato");
const btnElenco = document.getElementById("mostraElenco");
const divElenco = document.getElementById("elencoNomi");
const formContainer = document.getElementById("formContainer");

let elencoVisibile = false;
let nomiCache = null;

// --- Sistema di particelle migliorato ---
function createParticle() {
  const particle = document.createElement('div');
  particle.className = 'particle';

  particle.style.opacity = Math.random() * 0.2 + 0.8;
  particle.style.imageRendering = 'high-quality';
  
  // Dimensioni casuali
  const size = Math.random() * 70 + 30; // 30px - 100px
  particle.style.width = size + 'px';
  particle.style.height = size + 'px';
  
  // Posizione orizzontale casuale MA SOLO NELLA PARTE BASSA
  // Le particelle partono dal basso (80% in gi√π della pagina)
  particle.style.left = Math.random() * 100 + '%';
  particle.style.top = (80 + Math.random() * 20) + 'vh'; // 80-100vh (solo parte bassa)
  
  // Durata animazione casuale
  const duration = Math.random() * 10 + 15; // 15-25s
  particle.style.animationDuration = duration + 's';
  
  // Delay casuale
  particle.style.animationDelay = Math.random() * 5 + 's';
  
  // Direzione casuale (sinistra o destra)
  const direction = Math.random() > 0.5 ? 1 : -1;
  particle.style.setProperty('--direction', direction);
  
  document.getElementById('particles').appendChild(particle);
  
  // Rimuovi la particella dopo l'animazione
  setTimeout(() => {
    if (particle.parentNode) {
      particle.parentNode.removeChild(particle);
    }
  }, (duration + 5) * 1000);
}

// Crea particelle ogni 1-2 secondi
function startParticles() {
  createParticle();
  setTimeout(startParticles, Math.random() * 1000 + 1000);
}

// Inizia il sistema di particelle dopo il caricamento
window.addEventListener('load', () => {
  // Crea alcune particelle iniziali
  for (let i = 0; i < 15; i++) {
    setTimeout(() => createParticle(), i * 200);
  }
  setTimeout(startParticles, 3000);
});

// --- Chiamata AJAX per ottenere il messaggio ---
btnMessaggio.addEventListener("click", async () => {
  const nome = input.value.trim();
  if (!nome) {
    alert("Inserisci un nome valido!");
    return;
  }
  
  // Espande il container se non √® gi√† espanso
  if (!formContainer.classList.contains('expanded')) {
    formContainer.classList.add('expanded');
  }
  
  // Mostra il container risultato
  risultato.classList.add("visible");
  risultato.innerHTML = "<div class='loading'>Caricamento...</div>";

  try {
    const res = await fetch("/cerca", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ nome })
    });
    if (!res.ok) throw new Error("Errore " + res.status);
    const data = await res.json();
    risultato.innerHTML = `<p><strong>${nome}</strong>: ${data.messaggio}</p>`;
  } catch (err) {
    risultato.innerHTML = `<div class="error">Errore: ${err.message}</div>`;
  }
});

// --- Elenco nomi ---
btnElenco.addEventListener("click", async () => {
  // Espande il container se non √® gi√† espanso
  if (!formContainer.classList.contains('expanded')) {
    formContainer.classList.add('expanded');
  }
  
  if (!elencoVisibile) {
    divElenco.classList.add("visible");
    divElenco.innerHTML = "<div class='loading'>Caricamento nomi...</div>";
    try {
      const res = await fetch("/nomi");
      const data = await res.json();
      nomiCache = data;
      divElenco.innerHTML = "<ul>" + data.map(n => `<li>${n}</li>`).join("") + "</ul>";
    } catch (err) {
      divElenco.innerHTML = `<div class="error">Errore: ${err.message}</div>`;
    }
    elencoVisibile = true;
    btnElenco.textContent = "üôà Nascondi elenco";
  } else {
    divElenco.classList.remove("visible");
    btnElenco.textContent = "üìã Elenco ringraziati";
    elencoVisibile = false;
  }
});

// Enter key support
input.addEventListener("keypress", (e) => {
  if (e.key === "Enter") {
    btnMessaggio.click();
  }
});

// Effetto particelle al click dei bottoni
[btnMessaggio, btnElenco].forEach(btn => {
  btn.addEventListener('click', () => {
    for(let i = 0; i < 5; i++) {
      setTimeout(() => createParticle(), i * 200);
    }
  });
});
</script>
</body>
</html>